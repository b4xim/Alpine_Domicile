{"ast":null,"code":"import { createRenderStep } from './render-step.mjs';\nconst stepsOrder = [\"prepare\", \"read\", \"update\", \"preRender\", \"render\", \"postRender\"];\nconst maxElapsed = 40;\n\nfunction createRenderBatcher(scheduleNextBatch, allowKeepAlive) {\n  let runNextFrame = false;\n  let useDefaultElapsed = true;\n  const state = {\n    delta: 0,\n    timestamp: 0,\n    isProcessing: false\n  };\n  const steps = stepsOrder.reduce((acc, key) => {\n    acc[key] = createRenderStep(() => runNextFrame = true);\n    return acc;\n  }, {});\n\n  const processStep = stepId => steps[stepId].process(state);\n\n  const processBatch = timestamp => {\n    runNextFrame = false;\n    state.delta = useDefaultElapsed ? 1000 / 60 : Math.max(Math.min(timestamp - state.timestamp, maxElapsed), 1);\n    state.timestamp = timestamp;\n    state.isProcessing = true;\n    stepsOrder.forEach(processStep);\n    state.isProcessing = false;\n\n    if (runNextFrame && allowKeepAlive) {\n      useDefaultElapsed = false;\n      scheduleNextBatch(processBatch);\n    }\n  };\n\n  const wake = () => {\n    runNextFrame = true;\n    useDefaultElapsed = true;\n    if (!state.isProcessing) scheduleNextBatch(processBatch);\n  };\n\n  const schedule = stepsOrder.reduce((acc, key) => {\n    const step = steps[key];\n\n    acc[key] = function (process) {\n      let keepAlive = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      let immediate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (!runNextFrame) wake();\n      return step.schedule(process, keepAlive, immediate);\n    };\n\n    return acc;\n  }, {});\n\n  const cancel = process => stepsOrder.forEach(key => steps[key].cancel(process));\n\n  return {\n    schedule,\n    cancel,\n    state,\n    steps\n  };\n}\n\nexport { createRenderBatcher, stepsOrder };","map":{"version":3,"sources":["/Users/basimahamed/portfolio-starter/node_modules/framer-motion/dist/es/frameloop/batcher.mjs"],"names":["createRenderStep","stepsOrder","maxElapsed","createRenderBatcher","scheduleNextBatch","allowKeepAlive","runNextFrame","useDefaultElapsed","state","delta","timestamp","isProcessing","steps","reduce","acc","key","processStep","stepId","process","processBatch","Math","max","min","forEach","wake","schedule","step","keepAlive","immediate","cancel"],"mappings":"AAAA,SAASA,gBAAT,QAAiC,mBAAjC;AAEA,MAAMC,UAAU,GAAG,CACf,SADe,EAEf,MAFe,EAGf,QAHe,EAIf,WAJe,EAKf,QALe,EAMf,YANe,CAAnB;AAQA,MAAMC,UAAU,GAAG,EAAnB;;AACA,SAASC,mBAAT,CAA6BC,iBAA7B,EAAgDC,cAAhD,EAAgE;AAC5D,MAAIC,YAAY,GAAG,KAAnB;AACA,MAAIC,iBAAiB,GAAG,IAAxB;AACA,QAAMC,KAAK,GAAG;AACVC,IAAAA,KAAK,EAAE,CADG;AAEVC,IAAAA,SAAS,EAAE,CAFD;AAGVC,IAAAA,YAAY,EAAE;AAHJ,GAAd;AAKA,QAAMC,KAAK,GAAGX,UAAU,CAACY,MAAX,CAAkB,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC1CD,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAWf,gBAAgB,CAAC,MAAOM,YAAY,GAAG,IAAvB,CAA3B;AACA,WAAOQ,GAAP;AACH,GAHa,EAGX,EAHW,CAAd;;AAIA,QAAME,WAAW,GAAIC,MAAD,IAAYL,KAAK,CAACK,MAAD,CAAL,CAAcC,OAAd,CAAsBV,KAAtB,CAAhC;;AACA,QAAMW,YAAY,GAAIT,SAAD,IAAe;AAChCJ,IAAAA,YAAY,GAAG,KAAf;AACAE,IAAAA,KAAK,CAACC,KAAN,GAAcF,iBAAiB,GACzB,OAAO,EADkB,GAEzBa,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAASZ,SAAS,GAAGF,KAAK,CAACE,SAA3B,EAAsCR,UAAtC,CAAT,EAA4D,CAA5D,CAFN;AAGAM,IAAAA,KAAK,CAACE,SAAN,GAAkBA,SAAlB;AACAF,IAAAA,KAAK,CAACG,YAAN,GAAqB,IAArB;AACAV,IAAAA,UAAU,CAACsB,OAAX,CAAmBP,WAAnB;AACAR,IAAAA,KAAK,CAACG,YAAN,GAAqB,KAArB;;AACA,QAAIL,YAAY,IAAID,cAApB,EAAoC;AAChCE,MAAAA,iBAAiB,GAAG,KAApB;AACAH,MAAAA,iBAAiB,CAACe,YAAD,CAAjB;AACH;AACJ,GAbD;;AAcA,QAAMK,IAAI,GAAG,MAAM;AACflB,IAAAA,YAAY,GAAG,IAAf;AACAC,IAAAA,iBAAiB,GAAG,IAApB;AACA,QAAI,CAACC,KAAK,CAACG,YAAX,EACIP,iBAAiB,CAACe,YAAD,CAAjB;AACP,GALD;;AAMA,QAAMM,QAAQ,GAAGxB,UAAU,CAACY,MAAX,CAAkB,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC7C,UAAMW,IAAI,GAAGd,KAAK,CAACG,GAAD,CAAlB;;AACAD,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAW,UAACG,OAAD,EAAmD;AAAA,UAAzCS,SAAyC,uEAA7B,KAA6B;AAAA,UAAtBC,SAAsB,uEAAV,KAAU;AAC1D,UAAI,CAACtB,YAAL,EACIkB,IAAI;AACR,aAAOE,IAAI,CAACD,QAAL,CAAcP,OAAd,EAAuBS,SAAvB,EAAkCC,SAAlC,CAAP;AACH,KAJD;;AAKA,WAAOd,GAAP;AACH,GARgB,EAQd,EARc,CAAjB;;AASA,QAAMe,MAAM,GAAIX,OAAD,IAAajB,UAAU,CAACsB,OAAX,CAAoBR,GAAD,IAASH,KAAK,CAACG,GAAD,CAAL,CAAWc,MAAX,CAAkBX,OAAlB,CAA5B,CAA5B;;AACA,SAAO;AAAEO,IAAAA,QAAF;AAAYI,IAAAA,MAAZ;AAAoBrB,IAAAA,KAApB;AAA2BI,IAAAA;AAA3B,GAAP;AACH;;AAED,SAAST,mBAAT,EAA8BF,UAA9B","sourcesContent":["import { createRenderStep } from './render-step.mjs';\n\nconst stepsOrder = [\n    \"prepare\",\n    \"read\",\n    \"update\",\n    \"preRender\",\n    \"render\",\n    \"postRender\",\n];\nconst maxElapsed = 40;\nfunction createRenderBatcher(scheduleNextBatch, allowKeepAlive) {\n    let runNextFrame = false;\n    let useDefaultElapsed = true;\n    const state = {\n        delta: 0,\n        timestamp: 0,\n        isProcessing: false,\n    };\n    const steps = stepsOrder.reduce((acc, key) => {\n        acc[key] = createRenderStep(() => (runNextFrame = true));\n        return acc;\n    }, {});\n    const processStep = (stepId) => steps[stepId].process(state);\n    const processBatch = (timestamp) => {\n        runNextFrame = false;\n        state.delta = useDefaultElapsed\n            ? 1000 / 60\n            : Math.max(Math.min(timestamp - state.timestamp, maxElapsed), 1);\n        state.timestamp = timestamp;\n        state.isProcessing = true;\n        stepsOrder.forEach(processStep);\n        state.isProcessing = false;\n        if (runNextFrame && allowKeepAlive) {\n            useDefaultElapsed = false;\n            scheduleNextBatch(processBatch);\n        }\n    };\n    const wake = () => {\n        runNextFrame = true;\n        useDefaultElapsed = true;\n        if (!state.isProcessing)\n            scheduleNextBatch(processBatch);\n    };\n    const schedule = stepsOrder.reduce((acc, key) => {\n        const step = steps[key];\n        acc[key] = (process, keepAlive = false, immediate = false) => {\n            if (!runNextFrame)\n                wake();\n            return step.schedule(process, keepAlive, immediate);\n        };\n        return acc;\n    }, {});\n    const cancel = (process) => stepsOrder.forEach((key) => steps[key].cancel(process));\n    return { schedule, cancel, state, steps };\n}\n\nexport { createRenderBatcher, stepsOrder };\n"]},"metadata":{},"sourceType":"module"}